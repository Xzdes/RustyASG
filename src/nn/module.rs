//! Модуль, определяющий основной трейт `Module` для всех слоев нейронной сети.

use crate::tensor::Tensor;

/// Трейт, определяющий общий интерфейс для всех слоев/модулей.
///
/// В графовой архитектуре `Module` - это любой компонент, который может
/// добавлять в граф определенный паттерн операций и параметров.
pub trait Module {
    /// Выполняет "символьный" прямой проход, строя соответствующую часть графа.
    ///
    /// Принимает входной символьный тензор и возвращает выходной символьный тензор.
    fn forward(&self, inputs: &Tensor) -> Tensor;

    /// Возвращает список всех обучаемых параметров (в виде символьных тензоров),
    /// которые принадлежат этому модулю.
    fn parameters(&self) -> Vec<Tensor>;
}